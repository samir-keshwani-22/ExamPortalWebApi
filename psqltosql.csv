"display_id","pseudo_sql","sql"
D0001,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{amount} >= {10000}""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.amount >= '10000'\n);""}"
D0002,"{""result"": ""Q2_count > 0 AND Q1_count >= 3 AND (Q1_count/Q2_count)*100 >= 150 AND (Q1_sum/Q2_sum)*100 >= 150"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{amount} >= {5000}"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM 7 day before transaction date\nWHERE #{amount} >= {5000}"", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": ""#{amount} >= {5000}""}","{""result"": ""Q2_count > 0 and Q1_count >= 3 and (Q1_count/Q2_count)*100 >= 150 and (Q1_sum/Q2_sum)*100 >= 150"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.amount >= '5000' AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.amount >= '5000' AND\n    a.trans_date >= date_sub(day, 30, date_sub(day ,7 ,toDateTime(%(trans_date)s))) AND\n            a.trans_date <= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            t.trans_date >= date_sub(day, 30, date_sub(day ,7 ,toDateTime(%(trans_date)s))) AND\n            t.trans_date <= date_sub(day, 7, toDateTime(%(trans_date)s))\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.amount >= '5000'\n);""}"
D0003,"{""result"": ""Q1_count >= 5 AND Q1_sum < 5000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{s.acct_id} not in {d.related_parties} AND #{trans_type} = {Transfer}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{account} is {dest} AND #{s.acct_id} not in {d.related_parties} AND #{trans_type} = {Transfer}""}","{""result"": ""Q1_count >= 5 and Q1_sum < 5000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d AND NOT has(d.related_parties, s.acct_id) AND t.trans_type = 'Transfer' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND NOT has(d.related_parties, s.acct_id) AND t.trans_type = 'Transfer'\n);""}"
D0004,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 10000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {ATMDeposit, Payment, Deposit, Transfer, AssetSale}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{account} is {dest} AND #{trans_type} = {ATMDeposit, Payment, Deposit, Transfer, AssetSale}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 10000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type in ('ATMDeposit', 'Payment', 'Deposit', 'Transfer', 'AssetSale') AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type in ('ATMDeposit', 'Payment', 'Deposit', 'Transfer', 'AssetSale')\n);""}"
D0005,"{""result"": ""Q1_count >= 5 AND Q1_sum >= 20000 AND ( Q2_sum / Q1_sum ) * 100 >= 80"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {ATMDeposit, Payment, Deposit, Transfer, AssetSale}"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {source} AND #{trans_type} = {Transfer}"", ""variable_name"": ""Q2_sum""}], ""triggers"": ""#{account} is {source} AND #{trans_type} = {Transfer}""}","{""result"": ""Q1_count >= 5 and Q1_sum >= 20000 and ( Q2_sum / Q1_sum ) * 100 >= 80"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type in ('ATMDeposit', 'Payment', 'Deposit', 'Transfer', 'AssetSale') AND\n    a.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_sum"", ""sql_placeholder"": ""SELECT SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'Transfer' AND\n    a.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'Transfer'\n);""}"
D0006,"{""result"": ""Q1_count >= 5"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{s.acct_id} not in {d.related_parties} AND #{trans_type} = {Transfer} AND #{amount} >= {5000}"", ""variable_name"": ""Q1_count""}], ""triggers"": ""#{account} is {dest} AND #{trans_type} = {Transfer} AND #{s.acct_id} not in {d.related_parties} AND #{amount} >= {5000}""}","{""result"": ""Q1_count >= 5"", ""queries"": [{""variable_name"": ""Q1_count"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d AND NOT has(d.related_parties, s.acct_id) AND t.trans_type = 'Transfer' AND t.amount >= '5000' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND t.trans_type = 'Transfer' AND NOT has(d.related_parties, s.acct_id) AND t.amount >= '5000'\n);""}"
D0007,"{""result"": ""Q1_count >= 5"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {source} AND #{d.acct_id} not in {s.related_parties} AND #{trans_type} = {Transfer} AND #{amount} >= {5000}"", ""variable_name"": ""Q1_count""}], ""triggers"": ""#{account} is {source} AND #{trans_type} = {Transfer} AND #{d.acct_id} not in {s.related_parties} AND #{amount} >= {5000}""}","{""result"": ""Q1_count >= 5"", ""queries"": [{""variable_name"": ""Q1_count"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND COALESCE(s.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND NOT has(s.related_parties, d.acct_id) AND t.trans_type = 'Transfer' AND t.amount >= '5000' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND s.trans_date = %(trans_date)s AND t.trans_type = 'Transfer' AND NOT has(s.related_parties, d.acct_id) AND t.amount >= '5000'\n);""}"
D0008,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE (#{description} in {monitored_keywords_high} OR #{description} in {monitored_keywords_prohibited} OR #{purpose} in {monitored_keywords_high} OR #{purpose} in {monitored_keywords_prohibited})""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    ( t.description  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'High' AND r.name = 'monitored_keywords') OR t.description  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'Prohibited' AND r.name = 'monitored_keywords') OR t.purpose  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'High' AND r.name = 'monitored_keywords') OR t.purpose  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'Prohibited' AND r.name = 'monitored_keywords') )\n);""}"
D0009,"{""result"": ""(Q1_count >= 3 AND Q1_sum >= 10000) OR (Q2_count >= 3 AND Q2_sum >= 10000)"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {Deposit} AND #{trans_method} = {Cheque} AND #{s.entity_type} = {Business} AND #{s.risk_level} = {High} "", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {Transfer} AND #{s.entity_type} = {Business} AND #{s.risk_level} = {High} "", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": ""#{account} is {dest} AND (#{trans_type} = {Transfer} OR (#{trans_type} = {Deposit} AND #{trans_method} = {Cheque})) AND #{s.entity_type} = {Business} AND #{s.risk_level} = {High}""}","{""result"": ""(Q1_count >= 3 and Q1_sum >= 10000) or (Q2_count >= 3 and Q2_sum >= 10000)"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d AND t.trans_type = 'Deposit' AND t.trans_method = 'Cheque' AND s.entity_type = 'Business' AND s.risk_level = 'High' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d AND t.trans_type = 'Transfer' AND s.entity_type = 'Business' AND s.risk_level = 'High' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND ( t.trans_type = 'Transfer' OR ( t.trans_type = 'Deposit' AND t.trans_method = 'Cheque' ) ) AND s.entity_type = 'Business' AND s.risk_level = 'High'\n);""}"
D0010,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 10000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{s.acct_id} not in {d.related_parties} AND #{trans_type} = {Deposit} AND #{trans_method} = {Cheque}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{account} is {dest} AND #{trans_type} = {Deposit} AND #{trans_method} = {Cheque} AND #{s.acct_id} not in {d.related_parties}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 10000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d AND NOT has(d.related_parties, s.acct_id) AND t.trans_type = 'Deposit' AND t.trans_method = 'Cheque' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND t.trans_type = 'Deposit' AND t.trans_method = 'Cheque' AND NOT has(d.related_parties, s.acct_id)\n);""}"
D0011,"{""result"": ""Q1_count >= 3"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{account} is {source} AND #{s.addr_country} != {location} "", ""variable_name"": ""Q1_count""}], ""triggers"": ""#{account} is {source} AND #{s.addr_country} != {location}""}","{""result"": ""Q1_count >= 3"", ""queries"": [{""variable_name"": ""Q1_count"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND COALESCE(s.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND s.addr_country != t.location AND\n    d.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND s.trans_date = %(trans_date)s AND s.addr_country != t.location\n);""}"
D0012,"{""result"": ""Q1_count >= 5 AND Q2_count >= 10"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{s.acct_id} not in {d.related_parties} AND #{trans_type} = {ATMDeposit, Payment, Deposit, Transfer, AssetSale} AND #{amount} >= {10000}"", ""variable_name"": ""Q1_count""}, {""pseudo_query"": ""QUERY COUNT({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {source} AND #{d.acct_id} not in {s.related_parties} AND #{trans_type} = {Payment, LoanRepayment} AND #{amount} >= {5000}"", ""variable_name"": ""Q2_count""}], ""triggers"": ""#{account} is {source} AND #{d.acct_id} not in {s.related_parties} AND #{trans_type} = {Payment, LoanRepayment} AND #{amount} >= {5000}""}","{""result"": ""Q1_count >= 5 and Q2_count >= 10"", ""queries"": [{""variable_name"": ""Q1_count"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d AND NOT has(d.related_parties, s.acct_id) AND t.trans_type in ('ATMDeposit', 'Payment', 'Deposit', 'Transfer', 'AssetSale') AND t.amount >= '10000' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}, {""variable_name"": ""Q2_count"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND COALESCE(s.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND NOT has(s.related_parties, d.acct_id) AND t.trans_type in ('Payment', 'LoanRepayment') AND t.amount >= '5000' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND s.trans_date = %(trans_date)s AND NOT has(s.related_parties, d.acct_id) AND t.trans_type in ('Payment', 'LoanRepayment') AND t.amount >= '5000'\n);""}"
D0013,"{""result"": ""Q1_count + Q2_count >= 3"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{s.risk_level} = {High} AND #{amount} >= {10000}"", ""variable_name"": ""Q1_count""}, {""pseudo_query"": ""QUERY COUNT({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {source} AND #{d.risk_level} = {High} AND #{amount} >= {10000}"", ""variable_name"": ""Q2_count""}], ""triggers"": ""#{account} is {source} AND #{d.risk_level} = {High} AND #{amount} >= {10000}""}","{""result"": ""Q1_count + Q2_count >= 3"", ""queries"": [{""variable_name"": ""Q1_count"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d AND s.risk_level = 'High' AND t.amount >= '10000' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}, {""variable_name"": ""Q2_count"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND COALESCE(s.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND d.risk_level = 'High' AND t.amount >= '10000' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND s.trans_date = %(trans_date)s AND d.risk_level = 'High' AND t.amount >= '10000'\n);""}"
D0014,"{""result"": ""Q1_count + Q2_count >= 3"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{s.risk_level} = {High} AND #{amount} >= {10000}"", ""variable_name"": ""Q1_count""}, {""pseudo_query"": ""QUERY COUNT({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {source} AND #{d.risk_level} = {High} AND #{amount} >= {10000}"", ""variable_name"": ""Q2_count""}], ""triggers"": ""#{account} is {dest} AND #{s.risk_level} = {High} AND #{amount} >= {10000}""}","{""result"": ""Q1_count + Q2_count >= 3"", ""queries"": [{""variable_name"": ""Q1_count"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d AND s.risk_level = 'High' AND t.amount >= '10000' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}, {""variable_name"": ""Q2_count"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND COALESCE(s.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND d.risk_level = 'High' AND t.amount >= '10000' AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND s.risk_level = 'High' AND t.amount >= '10000'\n);""}"
D0015,"{""result"": ""(Q1_count >= 10 AND Q2_count >= 10 AND ((Q1_count-Q2_count)/Q2_count)*100 >= 50) OR (Q1_sum >= 10000 AND Q2_sum >= 10000 AND ((Q1_sum-Q2_sum)/Q2_sum)*100 >= 50)"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\n"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM 30 day before transaction date\n"", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": """"}","{""result"": ""(Q1_count >= 10 and Q2_count >= 10 and ((Q1_count-Q2_count)/Q2_count)*100 >= 50) or (Q1_sum >= 10000 and Q2_sum >= 10000 and ((Q1_sum-Q2_sum)/Q2_sum)*100 >= 50)"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n \n    a.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n \n    a.trans_date >= date_sub(day, 30, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            a.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            t.trans_date >= date_sub(day, 30, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            t.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s))\n);"", ""template_number"": 1}], ""triggers"": """"}"
D0016,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{account} is {dest} AND #{trans_type} = {Transfer} AND ( #{s.addr_country} in {country_risk_high} OR #{s.addr_country} in {country_risk_prohibited}) AND #{amount} >= {10000}""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND t.trans_type = 'Transfer' AND ( s.addr_country  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'High' AND r.name = 'country_risk') OR s.addr_country  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'Prohibited' AND r.name = 'country_risk') ) AND t.amount >= '10000'\n);""}"
D0017,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{account} is {source} AND #{trans_type} = {Transfer} AND  ( #{d.addr_country} in {country_risk_high} OR #{d.addr_country} in {country_risk_prohibited}) AND #{amount} >= {10000}""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND s.trans_date = %(trans_date)s AND t.trans_type = 'Transfer' AND ( d.addr_country  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'High' AND r.name = 'country_risk') OR d.addr_country  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'Prohibited' AND r.name = 'country_risk') ) AND t.amount >= '10000'\n);""}"
D0018,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 10000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {source} AND #{trans_type} = {AssetPurchase} AND #{asset_type} = {PreciousMetal, Artwork, Jewelry, PreciousStones}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{account} is {source} AND #{trans_type} = {AssetPurchase} AND #{asset_type} = {PreciousMetal, Artwork, Jewelry, PreciousStones}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 10000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'AssetPurchase' AND t.asset_type in ('PreciousMetal', 'Artwork', 'Jewelry', 'PreciousStones') AND\n    a.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'AssetPurchase' AND t.asset_type in ('PreciousMetal', 'Artwork', 'Jewelry', 'PreciousStones')\n);""}"
D0019,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 50000 AND Q1_sum/Q1_count > Q2_sum/Q2_count"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {Transfer}"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 90 day FROM 30 day before transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {Transfer}"", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": ""#{account} is {dest} AND #{trans_type} = {Transfer}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 50000 and Q1_sum/Q1_count > Q2_sum/Q2_count"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type = 'Transfer' AND\n    a.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type = 'Transfer' AND\n    a.trans_date >= date_sub(day, 90, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            a.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            t.trans_date >= date_sub(day, 90, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            t.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s))\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type = 'Transfer'\n);""}"
D0020,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 50000 AND Q1_sum/Q1_count > Q2_sum/Q2_count"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {source} AND #{trans_type} = {Transfer}"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 90 day FROM 30 day before transaction date\nWHERE #{account} is {source} AND #{trans_type} = {Transfer}"", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": ""#{account} is {source} AND #{trans_type} = {Transfer}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 50000 and Q1_sum/Q1_count > Q2_sum/Q2_count"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'Transfer' AND\n    a.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'Transfer' AND\n    a.trans_date >= date_sub(day, 90, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            a.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            t.trans_date >= date_sub(day, 90, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            t.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s))\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'Transfer'\n);""}"
D0021,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{account} is {dest} AND #{s.entity_type} = {Business} AND #{s.acct_id} not in {d.related_parties} AND #{amount} >= {10000}""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND s.entity_type = 'Business' AND NOT has(d.related_parties, s.acct_id) AND t.amount >= '10000'\n);""}"
D0022,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{account} is {source} AND #{d.entity_type} = {Business} AND #{d.acct_id} not in {s.related_parties} AND #{amount} >= {10000}""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND s.trans_date = %(trans_date)s AND d.entity_type = 'Business' AND NOT has(s.related_parties, d.acct_id) AND t.amount >= '10000'\n);""}"
D0023,"{""result"": ""Q1_count >= 5 OR Q1_sum >= 5000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {source} AND #{d.business_type} = {AuctionHighRisk, AuctionLuxury, AuctionGeneral, AuctionMetal} AND #{trans_type} = {Transfer, Payment, AssetPurchase}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{account} is {source} AND #{d.business_type} = {AuctionHighRisk, AuctionLuxury, AuctionGeneral, AuctionMetal} AND #{trans_type} = {Transfer, Payment, AssetPurchase}""}","{""result"": ""Q1_count >= 5 or Q1_sum >= 5000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \n    FROM cust_trans_info d\n        JOIN transactions t\n        ON d.trans_id = t.id\n        AND d.trans_acct_type = 'Destination'\n        JOIN cust_trans_info s\n        ON s.trans_id = t.id\n        AND s.trans_acct_type = 'Source'\n    WHERE \n    COALESCE(t.env, 0) = %(env_var)d AND\n    t.tenant_id = %(tenant_id)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND COALESCE(s.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND d.business_type in ('AuctionHighRisk', 'AuctionLuxury', 'AuctionGeneral', 'AuctionMetal') AND t.trans_type in ('Transfer', 'Payment', 'AssetPurchase') AND\n    d.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n        d.trans_date <= toDateTime(%(trans_date)s) AND \n        s.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        s.trans_date <= toDateTime(%(trans_date)s) AND\n        t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n        t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 2}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND s.trans_date = %(trans_date)s AND d.business_type in ('AuctionHighRisk', 'AuctionLuxury', 'AuctionGeneral', 'AuctionMetal') AND t.trans_type in ('Transfer', 'Payment', 'AssetPurchase')\n);""}"
D0024,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{trans_ip} in {ip_blacklist}""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_ip  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = '' AND r.name = 'ip_blacklist')\n);""}"
D0025,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{trans_ip} != { } AND #{acct_open_ip} != { } AND #{trans_ip} != {acct_open_ip}""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_ip is not null AND a.acct_open_ip is not null AND a.trans_ip != a.acct_open_ip\n);""}"
D0026,"{""result"": ""Q1_sum >= 10000 AND ((Q1_sum - Q2_sum)/Q2_sum)*100 >= 200"", ""queries"": [{""pseudo_query"": ""QUERY SUM({amount})\nFROM DATA\nPAST 1 day FROM transaction date\n"", ""variable_name"": ""Q1_sum""}, {""pseudo_query"": ""QUERY SUM({amount})\nFROM DATA\nPAST 30 day FROM 1 day before transaction date\n"", ""variable_name"": ""Q2_sum""}], ""triggers"": """"}","{""result"": ""Q1_sum >= 10000 and ((Q1_sum - Q2_sum)/Q2_sum)*100 >= 200"", ""queries"": [{""variable_name"": ""Q1_sum"", ""sql_placeholder"": ""SELECT SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n \n    a.trans_date >= date_sub(day, 1, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 1, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_sum"", ""sql_placeholder"": ""SELECT SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n \n    a.trans_date >= date_sub(day, 30, date_sub(day ,1 ,toDateTime(%(trans_date)s))) AND\n            a.trans_date <= date_sub(day, 1, toDateTime(%(trans_date)s)) AND\n            t.trans_date >= date_sub(day, 30, date_sub(day ,1 ,toDateTime(%(trans_date)s))) AND\n            t.trans_date <= date_sub(day, 1, toDateTime(%(trans_date)s))\n);"", ""template_number"": 1}], ""triggers"": """"}"
D0035,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{account} is {dest} AND #{d.acct_type} = {LoanAcct} AND #{s.reference} != {d.reference} AND #{amount} >= {50000}""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND d.acct_type = 'LoanAcct' AND s.reference != d.reference AND t.amount >= '50000'\n);""}"
D0027,"{""result"": ""Q1_sum >= 10000"", ""queries"": [{""pseudo_query"": ""QUERY SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{account} is {source} AND #{empl_status} = {Unemployed, SelfEmployed} AND #{trans_type} = {AssetPurchase} AND #{asset_type} = {PreciousMetal , Artwork, Jewelry, PreciousStones}"", ""variable_name"": ""Q1_sum""}], ""triggers"": ""#{account} is {source} AND #{empl_status} = {Unemployed, SelfEmployed} AND #{trans_type} = {AssetPurchase} AND #{asset_type} = {PreciousMetal , Artwork, Jewelry, PreciousStones}""}","{""result"": ""Q1_sum >= 10000"", ""queries"": [{""variable_name"": ""Q1_sum"", ""sql_placeholder"": ""SELECT SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND a.empl_status in ('Unemployed', 'SelfEmployed') AND t.trans_type = 'AssetPurchase' AND t.asset_type in ('PreciousMetal', 'Artwork', 'Jewelry', 'PreciousStones') AND\n    a.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Source' AND a.empl_status in ('Unemployed', 'SelfEmployed') AND t.trans_type = 'AssetPurchase' AND t.asset_type in ('PreciousMetal', 'Artwork', 'Jewelry', 'PreciousStones')\n);""}"
D0028,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 50000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 1 day FROM transaction date\nWHERE #{account} is {source} AND #{trans_type} = {Transfer}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{account} is {source} AND #{trans_type} = {Transfer}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 50000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'Transfer' AND\n    a.trans_date >= date_sub(day, 1, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 1, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'Transfer'\n);""}"
D0029,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 1000 AND (Q2_sum / Q1_sum ) * 100 >= 90"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {ATMDeposit, Payment, Deposit, Transfer, AssetSale}"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{account} is {source} AND #{trans_type} = {Withdrawal, Payment, AssetPurchase, Transfer, ATMWithdrawal, LoanRepayment, Bet}"", ""variable_name"": ""Q2_sum""}], ""triggers"": ""#{account} is {source} AND #{trans_type} = {Withdrawal, Payment, AssetPurchase, Transfer, ATMWithdrawal, LoanRepayment, Bet}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 1000 and (Q2_sum / Q1_sum ) * 100 >= 90"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type in ('ATMDeposit', 'Payment', 'Deposit', 'Transfer', 'AssetSale') AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_sum"", ""sql_placeholder"": ""SELECT SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type in ('Withdrawal', 'Payment', 'AssetPurchase', 'Transfer', 'ATMWithdrawal', 'LoanRepayment', 'Bet') AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type in ('Withdrawal', 'Payment', 'AssetPurchase', 'Transfer', 'ATMWithdrawal', 'LoanRepayment', 'Bet')\n);""}"
D0030,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 10000 "", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{trans_type} = {Deposit} AND #{trans_method} = {Cash}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{trans_type} = {Deposit} AND #{trans_method} = {Cash}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 10000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'Deposit' AND t.trans_method = 'Cash' AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.trans_type = 'Deposit' AND t.trans_method = 'Cash'\n);""}"
D0031,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 10000 AND (Q2_sum/Q1_sum)*100 >= 80"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{trans_type} = {Deposit} AND #{trans_method} = {Cash}"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{trans_type} = {Withdrawal} AND #{trans_method} = {Cash}"", ""variable_name"": ""Q2_sum""}], ""triggers"": ""#{trans_type} = {Withdrawal} AND #{trans_method} = {Cash}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 10000 and (Q2_sum/Q1_sum)*100 >= 80"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'Deposit' AND t.trans_method = 'Cash' AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_sum"", ""sql_placeholder"": ""SELECT SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'Withdrawal' AND t.trans_method = 'Cash' AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.trans_type = 'Withdrawal' AND t.trans_method = 'Cash'\n);""}"
D0032,"{""result"": ""Q1_count >= 3 AND Q2_count >= 3 AND Q1_sum + Q2_sum >= 10000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {Deposit} AND #{trans_method} = {Cash}"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {Transfer}"", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": ""#{account} is {dest} AND ((#{trans_type} = {Deposit} AND #{trans_method} = {Cash}) OR (#{trans_type} = {Transfer})) ""}","{""result"": ""Q1_count >= 3 and Q2_count >= 3 and Q1_sum + Q2_sum >= 10000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type = 'Deposit' AND t.trans_method = 'Cash' AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type = 'Transfer' AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Destination' AND ( ( t.trans_type = 'Deposit' AND t.trans_method = 'Cash' ) OR ( t.trans_type = 'Transfer' ) )\n);""}"
D0033,"{""result"": ""Q1_count >= 5 AND Q1_sum >= 5000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{account} is {source} AND #{trans_type} = {ATMWithdrawal}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{account} is {source} AND #{trans_type} = {ATMWithdrawal}""}","{""result"": ""Q1_count >= 5 and Q1_sum >= 5000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'ATMWithdrawal' AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'ATMWithdrawal'\n);""}"
D0034,"{""result"": ""Q1_count >= 5 AND Q1_sum >= 5000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{account} is {source} AND #{trans_type} = {ATMWithdrawal} AND #{addr_country} != {location}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{account} is {source} AND #{trans_type} = {ATMWithdrawal} AND #{addr_country} != {location}""}","{""result"": ""Q1_count >= 5 and Q1_sum >= 5000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'ATMWithdrawal' AND a.addr_country != t.location AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type = 'ATMWithdrawal' AND a.addr_country != t.location\n);""}"
D0036,"{""result"": ""Q1_count >= 5 AND Q2_count >= 5 AND Q1_sum >= 5000 AND ((Q1_sum-(Q2_sum/2))/(Q2_sum/2))*100 >= 50"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{trans_type} = {Deposit} AND #{trans_method} = {Cash}"", ""variable_name"": ""Q1_count,Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 60 day FROM 30 day before transaction date\nWHERE #{trans_type} = {Deposit} AND #{trans_method} = {Cash}"", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": ""#{trans_type} = {Deposit} AND #{trans_method} = {Cash}""}","{""result"": ""Q1_count >= 5 and Q2_count >= 5 and Q1_sum >= 5000 and ((Q1_sum-(Q2_sum/2))/(Q2_sum/2))*100 >= 50"", ""queries"": [{""variable_name"": ""Q1_count,Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'Deposit' AND t.trans_method = 'Cash' AND\n    a.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'Deposit' AND t.trans_method = 'Cash' AND\n    a.trans_date >= date_sub(day, 60, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            a.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            t.trans_date >= date_sub(day, 60, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            t.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s))\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.trans_type = 'Deposit' AND t.trans_method = 'Cash'\n);""}"
D0037,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 10000"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 10 minute FROM transaction date\nWHERE #{industry} = {Crypto}"", ""variable_name"": ""Q1_count, Q1_sum""}], ""triggers"": ""#{industry} = {Crypto}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 10000"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.industry = 'Crypto' AND\n    a.trans_date >= date_sub(minute, 10, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(minute, 10, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.industry = 'Crypto'\n);""}"
D0038,"{""result"": ""Q1_count >= 3 AND Q1_sum >= 5000 AND ( Q2_sum / Q1_sum ) * 100 >= 80"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 1 day FROM transaction date\nWHERE #{account} is {dest} AND #{trans_type} = {ATMDeposit, Payment, Deposit, Transfer, AssetSale} AND #{industry} = {Crypto}"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY SUM({amount})\nFROM DATA\nPAST 1 day FROM transaction date\nWHERE #{account} is {source} AND #{trans_type} = {Withdrawal, Payment, AssetPurchase, Transfer, ATMWithdrawal, LoanRepayment, Bet} AND #{industry} = {Crypto}"", ""variable_name"": ""Q2_sum""}], ""triggers"": ""#{account} is {source} AND #{trans_type} = {Withdrawal, Payment, AssetPurchase, Transfer, ATMWithdrawal, LoanRepayment, Bet} AND #{industry} = {Crypto}""}","{""result"": ""Q1_count >= 3 and Q1_sum >= 5000 and ( Q2_sum / Q1_sum ) * 100 >= 80"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Destination' AND t.trans_type in ('ATMDeposit', 'Payment', 'Deposit', 'Transfer', 'AssetSale') AND t.industry = 'Crypto' AND\n    a.trans_date >= date_sub(day, 1, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 1, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_sum"", ""sql_placeholder"": ""SELECT SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type in ('Withdrawal', 'Payment', 'AssetPurchase', 'Transfer', 'ATMWithdrawal', 'LoanRepayment', 'Bet') AND t.industry = 'Crypto' AND\n    a.trans_date >= date_sub(day, 1, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 1, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    a.trans_acct_type = 'Source' AND t.trans_type in ('Withdrawal', 'Payment', 'AssetPurchase', 'Transfer', 'ATMWithdrawal', 'LoanRepayment', 'Bet') AND t.industry = 'Crypto'\n);""}"
D0039,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{account} is {source} AND #{d.acct_type} = {WalletAddr} AND (#{d.acct_id} in {wallet_address_blacklist})""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    s.tenant_id = %(tenant_id)s AND s.acct_id = %(acct_id)s AND s.trans_date = %(trans_date)s AND d.acct_type = 'WalletAddr' AND ( d.acct_id  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = '' AND r.name = 'wallet_address_blacklist') )\n);""}"
D0040,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{account} is {dest} AND #{s.acct_type} = {WalletAddr} AND (#{s.acct_id} in {wallet_address_blacklist})""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND s.acct_type = 'WalletAddr' AND ( s.acct_id  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = '' AND r.name = 'wallet_address_blacklist') )\n);""}"
D0041,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{industry} = {Crypto} AND #{trans_type} = {ATMDeposit, ATMWithdrawal} AND ( #{location} in {country_risk_high} OR #{location} in {country_risk_prohibited} )""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.industry = 'Crypto' AND t.trans_type in ('ATMDeposit', 'ATMWithdrawal') AND ( t.location  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'High' AND r.name = 'country_risk') OR t.location  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'Prohibited' AND r.name = 'country_risk') )\n);""}"
D0042,"{""result"": ""Q2_count > 0 AND ( Q1_sum / Q2_sum ) * 100 >= 150"", ""queries"": [{""pseudo_query"": ""QUERY SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{trans_type} = {CryptoSale} AND #{trans_method} = {CryptoCurrency} "", ""variable_name"": ""Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM 7 day before transaction date\nWHERE #{trans_type} = {CryptoSale} AND #{trans_method} = {CryptoCurrency}"", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": ""#{trans_type} = {CryptoSale} AND #{trans_method} = {CryptoCurrency} AND #{amount} >= {5000}""}","{""result"": ""Q2_count > 0 and ( Q1_sum / Q2_sum ) * 100 >= 150"", ""queries"": [{""variable_name"": ""Q1_sum"", ""sql_placeholder"": ""SELECT SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'CryptoSale' AND t.trans_method = 'CryptoCurrency' AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'CryptoSale' AND t.trans_method = 'CryptoCurrency' AND\n    a.trans_date >= date_sub(day, 30, date_sub(day ,7 ,toDateTime(%(trans_date)s))) AND\n            a.trans_date <= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            t.trans_date >= date_sub(day, 30, date_sub(day ,7 ,toDateTime(%(trans_date)s))) AND\n            t.trans_date <= date_sub(day, 7, toDateTime(%(trans_date)s))\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.trans_type = 'CryptoSale' AND t.trans_method = 'CryptoCurrency' AND t.amount >= '5000'\n);""}"
D0043,"{""result"": ""Q2_count > 0 AND ( Q1_sum / Q2_sum ) * 100 >= 150"", ""queries"": [{""pseudo_query"": ""QUERY SUM({amount})\nFROM DATA\nPAST 7 day FROM transaction date\nWHERE #{trans_type} = {CryptoPurchase} AND #{trans_method} = {Cash , CreditCard} "", ""variable_name"": ""Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM 7 day before transaction date\nWHERE #{trans_type} = {CryptoPurchase} AND #{trans_method} = {Cash , CreditCard}"", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": ""#{trans_type} = {CryptoPurchase} AND #{trans_method} = {Cash , CreditCard} AND #{amount} >= {5000}""}","{""result"": ""Q2_count > 0 and ( Q1_sum / Q2_sum ) * 100 >= 150"", ""queries"": [{""variable_name"": ""Q1_sum"", ""sql_placeholder"": ""SELECT SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'CryptoPurchase' AND t.trans_method in ('Cash', 'CreditCard') AND\n    a.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 7, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'CryptoPurchase' AND t.trans_method in ('Cash', 'CreditCard') AND\n    a.trans_date >= date_sub(day, 30, date_sub(day ,7 ,toDateTime(%(trans_date)s))) AND\n            a.trans_date <= date_sub(day, 7, toDateTime(%(trans_date)s)) AND\n            t.trans_date >= date_sub(day, 30, date_sub(day ,7 ,toDateTime(%(trans_date)s))) AND\n            t.trans_date <= date_sub(day, 7, toDateTime(%(trans_date)s))\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.trans_type = 'CryptoPurchase' AND t.trans_method in ('Cash', 'CreditCard') AND t.amount >= '5000'\n);""}"
D0044,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{account} is {dest} AND ( #{s.trans_ip} in {country_risk_high} OR #{s.trans_ip} in {country_risk_prohibited})""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    d.tenant_id = %(tenant_id)s AND d.acct_id = %(acct_id)s AND d.trans_date = %(trans_date)s AND ( s.trans_ip  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'High' AND r.name = 'country_risk') OR s.trans_ip  in  (SELECT c.value FROM ref_list_items c JOIN ref_list r ON c.reference_id = r.id WHERE c.tenant_id = %(tenant_id)s AND c.risk_level = 'Prohibited' AND r.name = 'country_risk') )\n);""}"
D0045,"{""result"": ""(Q1_count >= 5 AND ((Q1_count-(Q2_count/12))/ (Q2_count/12))*100 >= 30) OR (Q1_sum >= 10000 AND ((Q1_sum-(Q2_sum/12))/ (Q2_sum/12))*100 >= 30)"", ""queries"": [{""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 30 day FROM transaction date\nWHERE #{trans_type} = {Bet}"", ""variable_name"": ""Q1_count, Q1_sum""}, {""pseudo_query"": ""QUERY COUNT({amount}), SUM({amount})\nFROM DATA\nPAST 365 day FROM 30 day before transaction date\nWHERE #{trans_type} = {Bet}"", ""variable_name"": ""Q2_count, Q2_sum""}], ""triggers"": ""#{trans_type} = {Bet}""}","{""result"": ""(Q1_count >= 5 and ((Q1_count-(Q2_count/12))/ (Q2_count/12))*100 >= 30) or (Q1_sum >= 10000 and ((Q1_sum-(Q2_sum/12))/ (Q2_sum/12))*100 >= 30)"", ""queries"": [{""variable_name"": ""Q1_count, Q1_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'Bet' AND\n    a.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            a.trans_date <= toDateTime(%(trans_date)s) AND \n            t.trans_date >= date_sub(day, 30, toDateTime(%(trans_date)s)) AND \n            t.trans_date <= toDateTime(%(trans_date)s)\n);"", ""template_number"": 1}, {""variable_name"": ""Q2_count, Q2_sum"", ""sql_placeholder"": ""SELECT COUNT(t.amount) as Count, SUM(t.amount) as Sum \nFROM \n    cust_trans_info a\n    JOIN transactions t ON a.trans_id = t.id \nWHERE \n    (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND\n    a.tenant_id = %(tenant_id)s AND\n    t.tenant_id = %(tenant_id)s AND\n    a.acct_id = %(acct_id)s AND (\n    t.trans_type = 'Bet' AND\n    a.trans_date >= date_sub(day, 365, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            a.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s)) AND\n            t.trans_date >= date_sub(day, 365, date_sub(day ,30 ,toDateTime(%(trans_date)s))) AND\n            t.trans_date <= date_sub(day, 30, toDateTime(%(trans_date)s))\n);"", ""template_number"": 1}], ""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info a\n    JOIN transactions t \n    ON t.id = a.trans_id \nWHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(a.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\na.tenant_id = %(tenant_id)s AND\nt.tenant_id = %(tenant_id)s AND\na.acct_id = %(acct_id)s AND\na.trans_date = %(trans_date)s AND (\n    t.trans_type = 'Bet'\n);""}"
D0046,"{""triggers"": ""QUERY COUNT(*)\nFROM DATA\nWHERE #{trans_type} = {InsuranceSurrender} AND #{amount} >= {10000} AND #{s.reference} != {d.reference} ""}","{""triggers"": ""SELECT COUNT(*) \nFROM cust_trans_info d\n    JOIN transactions t\n    ON d.trans_id = t.id\n    AND d.trans_acct_type = 'Destination'\n    JOIN cust_trans_info s\n    ON s.trans_id = t.id\n    AND s.trans_acct_type = 'Source'\n    WHERE (COALESCE(t.env, 0) = %(env_var)d AND COALESCE(d.env, 0) = %(env_var)d AND COALESCE(s.env, 0) = %(env_var)d) AND t.id = %(trans_id)s AND\nt.tenant_id = %(tenant_id)s AND\nt.trans_date = %(trans_date)s AND (\n    t.trans_type = 'InsuranceSurrender' AND t.amount >= '10000' AND s.reference != d.reference\n);""}"
